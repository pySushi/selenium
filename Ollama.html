<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <title>Ollama</title>
    <script>
        // This is highly insecure and should not be used in production
        const OPENAI_API_KEY = 'ollama';


        // Assuming OPENAI_API_KEY and askQuestion function are defined here

        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('question').addEventListener('keypress', function (event) {
                if (event.key === 'Enter') {
                    event.preventDefault(); // Prevent the default action to stop form submission or any other bound behavior
                    askQuestion();
                }
            });
        });

        async function askQuestion() {
            const questionInput = document.getElementById('question');
            const answerDisplay = document.getElementById('answer');
            const question = questionInput.value;

            if (!question) {
                alert('Please enter a question.');
                return;
            }

            answerDisplay.textContent = "Fetching answer...";

            fetch('http://localhost:11434/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    "model": "qwen:0.5b-chat",
                    "messages": [
                        {
                            "role": "user",
                            "content": question
                        }
                    ],
                    "stream": false
                })
            })
                .then(response => response.json())
                .then(data => {
                    answerDisplay.textContent = data.message.content;
                })
                .catch(error => {
                    console.error('Error:', error);
                    answerDisplay.textContent = "An error occurred. Please try again.<br/>" + error;
                });
        }
    </script>
</head>

<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <div class="mb-4">
            <h1 class="text-xl font-bold text-gray-700">Ask a Question</h1>
            <div class="mt-4 gap-1 flex items-center">
                <input type="text" id="question" placeholder="Enter your question here"
                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                <button onclick="askQuestion()"
                    class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Ask</button>
            </div>
        </div>
        <p id="answer" class="mt-8 prose text-gray-600">Answer will appear here...</p>
    </div>
</body>

</html>